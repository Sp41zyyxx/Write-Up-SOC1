TASK 3
Q1. What is the SHA256 hash of the capture.pcapng file?
The SHA256 hash was obtained using Get-FileHash with the SHA256 algorithm.

Q2. What is the SHA256 hash of the sysmon.evtx file?
The SHA256 hash was calculated using Get-FileHash with the SHA256 algorithm.

Q3. What is the SHA256 hash of the windows.evtx file?
The SHA256 hash was generated using Get-FileHash with the SHA256 algorithm.

TASK 4
Q1. The user of this machine was compromised by a malicious document. What is the file name of the document?
The malicious document was identified using Wireshark by filtering HTTP GET requests. Knowing that the file had a .doc extension, the traffic was analyzed to locate a GET request downloading a document, which revealed the malicious file.

Q2. What is the name of the compromised user and machine?
Format: username-machine name
I used Find in the Sysmon logs to search for free_magicules.doc. The resulting event shows the download path, which reveals the username, and the Computer field, which identifies the machine name.

Q3. What is the PID of the Microsoft Word process that opened the malicious document?
To identify the PID of the Microsoft Word process, I used Find to search for the malicious document name. The corresponding event shows Microsoft Word as the process, where the ProcessId field reveals the PID

Q4. Based on Sysmon logs, what is the IPv4 address resolved by the malicious domain used in the previous question?  
According to the Sysmon logs, the malicious domain phishteam.xyz identified in the previous question was analyzed. To determine the resolved IPv4 address, the domain was searched on VirusTotal, where the associated IP addresses are listed.

Q5. What is the base64 encoded string in the malicious payload executed by the document?
To identify the Base64 encoded string, I used Find in the Sysmon logs and searched for Base64. The matching event shows the malicious payload execution, where the CommandLine field contains the Base64-encoded string.

Q6. What is the CVE number of the exploit used by the attacker to achieve a remote code execution? 
We can use any AI tool and paste the full CommandLine to identify the vulnerability, as the decoded payload and process behavior clearly indicate exploitation of CVE-****-***** (Follina).

TASK 5
Q1.The malicious execution of the payload wrote a file on the system. What is the full target path of the payload?
We already found this in the $app variable earlier.  (Q5 TASK 4)

Q2.The implanted payload executes once the user logs into the machine. What is the executed command upon a successful login of the compromised user?
Format: Remove the double quotes from the log.
To identify the executed command upon user login, I filtered the Sysmon logs for Event ID 1 (Process Create) and reviewed the ParentCommandLine field.
Using known indicators such as http://phishteam.xyz, and correlating with Wireshark data showing that First.exe was downloaded from the same domain, I was able to identify the command executed when the compromised user logged in.

Q3.Based on Sysmon logs, what is the SHA256 hash of the malicious binary downloaded for stage 2 execution?
Based on the Sysmon logs, I identified the Event ID 1 corresponding to the stage-2 execution found in Q2. In the same event, the Hashes field contains the SHA256 hash of the malicious binary downloaded and executed during stage 2.

Q4. The stage 2 payload downloaded establishes a connection to a c2 server. What is the domain and port used by the attacker?
Format: domain:port
Knowing the IP from Task 4 Q4, I filtered the Sysmon network events using that IP and searched for the associated domain and port.
This revealed the C2 server used by the stage-2 payload in the format domain:port.

TASK 6
Q1.What is the URL of the malicious payload embedded in the document?
By filtering the traffic for HTTP GET requests, several connections are observed. One specific GET request stands out as it downloads a suspicious file. Correlating this request with execution events confirms it as the malicious payload delivered by the document.

Q2.What is the encoding used by the attacker on the c2 connection?
We already knew this.

Q3.The malicious c2 binary sends a payload using a parameter that contains the executed command results. What is the parameter used by the binary?
By filtering the network traffic for HTTP GET requests, a request can be observed containing a query string parameter in the format ?*=.... Based on this behavior, the parameter used by the malicious C2 binary to send executed command results is identified.

Q4.The malicious c2 binary connects to a specific URL to get the command to be executed. What is the URL used by the binary?
By analyzing the same network event, the malicious C2 binary is observed connecting to a specific URL to retrieve commands to be executed.

Q5.What is the HTTP method used by the binary?
Same event too

Q6.Based on the user agent, what programming language was used by the attacker to compile the binary? 
Format: Answer in lowercase
Same event, but we have to see user-agent

TASK 7
Q1.The attacker was able to discover a sensitive file inside the machine of the user. What is the password discovered on the aforementioned file?
The attacker used the q parameter to transmit Base64-encoded commands via the C2 channel. Decoding the parameter revealed a command that accessed a sensitive file, exposing the password and more.

Q2.The attacker then enumerated the list of listening ports inside the machine. What is the listening port that could provide a remote shell inside the machine?
The attacker executed a netstat command via the C2 communication to enumerate open and listening ports. Analysis of the output showed a service listening on a specific port that could allow remote shell access.

Q3.The attacker then established a reverse socks proxy to access the internal services hosted inside the machine. What is the command executed by the attacker to establish the connection?
Format: Remove the double quotes from the log.
The Base64-decoded PowerShell command revealed the download of ch.exe via Invoke-WebRequest. By searching for ch.exe in sysmon.evtx, the relevant Sysmon event was identified, allowing us to determine the answer.

Q4.What is the SHA256 hash of the binary used by the attacker to establish the reverse socks proxy connection?
We know that

Q5.What is the name of the tool used by the attacker based on the SHA256 hash? Provide the answer in lowercase.
After identifying the SHA256 hash of the malicious binary in Q4, the hash was searched on VirusTotal. The analysis results revealed that the file corresponds to a known offensive security tool used by the attacker.

Q6.The attacker then used the harvested credentials from the machine. Based on the succeeding process after the execution of the socks proxy, what service did the attacker use to authenticate?
Format: Answer in lowercase

After successfully harvesting valid credentials, the attacker established a SOCKS proxy connection to enable further lateral movement.
To determine which service was used for authentication, Sysmon events associated with the user benimaru were reviewed after the SOCKS connection was established at June 20, 2022, 5:18:50 PM.
Filtering for Sysmon Event ID 1 (Process Creation) revealed the execution of wsmprovhost.exe, which is the host process for Windows Remote Management (WinRM) plug-ins.
The presence of this process indicates that the attacker authenticated to the system using the WinRM service.

